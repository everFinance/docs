<!doctype html>
<html class="docs-version-current" lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PZ2J4TP"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PZ2J4TP",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="everPay Docs" href="/opensearch.xml"><title data-react-helmet="true">äº¤æ˜“ | everPay Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.everpay.io/docs/guide/dive/transaction"><meta data-react-helmet="true" name="docsearch:language" content="zh-cn"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="äº¤æ˜“ | everPay Docs"><meta data-react-helmet="true" name="description" content="everPay æœ‰è‡ªå·±ç‹¬ç«‹çš„äº¤æ˜“æ ¼å¼ï¼Œæ‰€æœ‰çš„ everPay äº¤æ˜“éƒ½éµå¾ªç›¸åŒçš„æ ¼å¼ï¼Œç­¾ç½²ç›¸åŒçš„ç­¾åè§„èŒƒï¼Œå­˜å‚¨åœ¨ arweave åŒºå—é“¾ä¸Šï¼Œä¾›æ‰€æœ‰äººéªŒè¯ã€‚"><meta data-react-helmet="true" property="og:description" content="everPay æœ‰è‡ªå·±ç‹¬ç«‹çš„äº¤æ˜“æ ¼å¼ï¼Œæ‰€æœ‰çš„ everPay äº¤æ˜“éƒ½éµå¾ªç›¸åŒçš„æ ¼å¼ï¼Œç­¾ç½²ç›¸åŒçš„ç­¾åè§„èŒƒï¼Œå­˜å‚¨åœ¨ arweave åŒºå—é“¾ä¸Šï¼Œä¾›æ‰€æœ‰äººéªŒè¯ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.everpay.io/docs/guide/dive/transaction"><link data-react-helmet="true" rel="alternate" href="https://docs.everpay.io/en/docs/guide/dive/transaction" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.everpay.io/docs/guide/dive/transaction" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://docs.everpay.io/docs/guide/dive/transaction" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://AI0VA1UPRC-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48824a1d.css">
<link rel="preload" href="/assets/js/runtime~main.2c9cfe4d.js" as="script">
<link rel="preload" href="/assets/js/main.c9bb03f8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo-black.svg" alt="everPay Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-white.svg" alt="everPay Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">everPay Docs</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/guide/quick-start/overview">æŒ‡å—</a><a class="navbar__item navbar__link" href="/docs/sdk/intro">SDK</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/en/docs/guide/dive/transaction" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/docs/guide/dive/transaction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><a href="https://github.com/everFinance/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¿«é€Ÿå¼€å§‹</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">æ·±å…¥ç†è§£</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/overview">ç³»ç»Ÿæ¦‚è§ˆ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/account-model">è´¦æˆ·æ¨¡å‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guide/dive/transaction">äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/deposit">å……å€¼</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/transfer">è½¬è´¦</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/withdraw">æç°</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/bundle">æ‰¹é‡è½¬è´¦</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/dive/swap">å…‘æ¢</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å»¶ä¼¸</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>äº¤æ˜“</h1></header><p>everPay æœ‰è‡ªå·±ç‹¬ç«‹çš„äº¤æ˜“æ ¼å¼ï¼Œæ‰€æœ‰çš„ everPay äº¤æ˜“éƒ½éµå¾ªç›¸åŒçš„æ ¼å¼ï¼Œç­¾ç½²ç›¸åŒçš„ç­¾åè§„èŒƒï¼Œå­˜å‚¨åœ¨ arweave åŒºå—é“¾ä¸Šï¼Œä¾›æ‰€æœ‰äººéªŒè¯ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="schema"></a>Schema<a class="hash-link" href="#schema" title="Direct link to heading">#</a></h2><table><thead><tr><th>å­—æ®µ</th><th>æè¿°</th></tr></thead><tbody><tr><td>tokenSymbol</td><td>ä»£å¸åç§°</td></tr><tr><td>action</td><td><ul><li><code>&#x27;mint&#x27;</code>ä»£è¡¨å……å€¼</li><li><code>&#x27;transfer&#x27;</code>ä»£è¡¨è½¬è´¦</li><li><code>&#x27;burn&#x27;</code>ä»£è¡¨æç°</li><li><code>&#x27;bundle&#x27;</code>ä»£è¡¨æ‰¹é‡è½¬è´¦</li></ul></td></tr><tr><td>from</td><td>ç­¾åäº¤æ˜“çš„å½“å‰ everPay è´¦æˆ· ID</td></tr><tr><td>to</td><td><ul><li>è½¬è´¦æ—¶ï¼Œ<code>to</code> ä¸ºå¦ä¸€ä¸ª everPay è´¦æˆ· ID</li><li>æç°æ—¶ï¼Œ<code>to</code> ä¸ºè¦æç°è‡³çš„åŒºå—é“¾é’±åŒ…åœ°å€</li><li>æ‰¹é‡è½¬è´¦æ—¶ï¼Œ<code>to</code> ä»£è¡¨å¤–éƒ¨è½¬è´¦æ”¶æ¬¾çš„ everPay è´¦æˆ· IDï¼Œå¯ä¸ºä»»æ„ everPay è´¦æˆ· IDï¼ˆåŒ…æ‹¬ç­¾åäº¤æ˜“çš„å½“å‰ everPay è´¦æˆ· IDï¼‰</li></ul></td></tr><tr><td>amount</td><td>ç±»å‹ä¸º uintï¼Œè®¾ç½®æ—¶éœ€è¦è¿›è¡Œ <code>decimals</code> å¤„ç†ï¼Œä¾‹å¦‚ 0.1USDTï¼Œæ­¤å¤„ç»è¿‡ USDT çš„ <code>decimals: 6</code> å¤„ç†åï¼Œä¸º 100000 <ul><li>è½¬è´¦æ—¶ï¼Œ<code>amount</code> ä¸ºè½¬è´¦é‡‘é¢</li><li>æç°æ—¶ï¼Œ<code>amount</code> ä¸ºæç°é‡‘é¢</li><li>æ‰¹é‡è½¬è´¦æ—¶ï¼Œ<code>amount</code> ä¸ºå¤–éƒ¨è½¬è´¦é‡‘é¢</li></ul></td></tr><tr><td>fee</td><td>æ‰‹ç»­è´¹ï¼Œç±»å‹ä¸º uintã€‚éœ€è¦è¿›è¡Œ decimals å¤„ç†ï¼Œä¾‹å¦‚ 0.1USDTï¼Œæ­¤å¤„ç»è¿‡ USDT çš„ <code>decimals: 6</code> å¤„ç†åï¼Œä¸º 100000</td></tr><tr><td>feeRecipient</td><td>æ‰‹ç»­è´¹æ”¶æ¬¾ everPay è´¦æˆ· IDï¼Œé€šè¿‡ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–</td></tr><tr><td>nonce</td><td>unix millisecondsï¼Œunix æ¯«ç§’æ—¶é—´æˆ³</td></tr><tr><td>tokenID</td><td>é€šè¿‡ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–ï¼Œå¿…é¡»ä¸ <code>tokenSymbol</code> å¯¹åº”çš„ token <code>id</code> å­—æ®µ<strong>ä¸€è‡´</strong></td></tr><tr><td>chainType</td><td><ul><li>è½¬è´¦æ—¶ï¼Œ<code>chainType</code> å¿…é¡»ä¸ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–çš„ <code>tokenSymbol</code> å¯¹åº” token <code>chainType</code> <strong>ä¸€è‡´</strong></li><li>æç°æ—¶ï¼Œ<code>chainType</code> ä¸ºè¦æç°è‡³çš„åŒºå—é“¾åç§°ã€‚ä¾‹å¦‚ AR Token æ”¯æŒæç°è‡³ Arweave å’Œä»¥å¤ªåŠåŒºå—é“¾ï¼Œtoken <code>chainType</code> å­—æ®µä¸º <code>arweave,ethereum</code>ï¼Œå¼€å‘è€…éœ€è¦æŒ‡å®šæç°è‡³å“ªä¸ªåŒºå—é“¾ï¼Œ<code>arweave</code>ä¸º Arweave åŒºå—é“¾ï¼Œ<code>ethereum</code> ä¸ºä»¥å¤ªåŠåŒºå—é“¾ã€‚</li><li>æ‰¹é‡è½¬è´¦æ—¶ï¼Œ<code>chainType</code> å¿…é¡»ä¸ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–çš„ <code>tokenSymbol</code> å¯¹åº” token <code>chainType</code> <strong>ä¸€è‡´</strong></li></ul></td></tr><tr><td>chainID</td><td><ul><li>è½¬è´¦æ—¶ï¼Œ<code>chainID</code> å¿…é¡»ä¸ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–çš„ <code>tokenSymbol</code> å¯¹åº” <code>chainID</code> <strong>ä¸€è‡´</strong></li><li>æç°æ—¶ï¼Œ<code>chainID</code> ä¸ºè¦æç°è‡³çš„åŒºå—é“¾ç½‘ç»œ IDï¼Œä¾‹å¦‚ AR Token æ”¯æŒæç°è‡³ Arweave å’Œä»¥å¤ªåŠåŒºå—é“¾ï¼Œtoken <code>chainID</code> å­—æ®µä¸º <code>0,1</code>ï¼Œå¼€å‘è€…æŒ‡å®šæç°è‡³å“ªä¸ªåŒºå—é“¾ï¼Œ<code>chainID</code> ä¹Ÿéœ€è¦ä½¿ç”¨å¯¹åº”çš„å€¼ï¼Œ<code>0</code>ä¸º Arweave åŒºå—é“¾ç½‘ç»œ IDï¼Œ<code>1</code> ä¸ºä»¥å¤ªåŠåŒºå—é“¾ç½‘ç»œ ID</li><li>æ‰¹é‡è½¬è´¦æ—¶ï¼Œ<code>chainID</code> å¿…é¡»ä¸ <a href="/docs/sdk/server-api/basic-api/info">info API</a> æ¥å£è·å–çš„ <code>tokenSymbol</code> å¯¹åº” <code>chainID</code> <strong>ä¸€è‡´</strong></li></ul></td></tr><tr><td>data</td><td>é™„åŠ ä¿¡æ¯ï¼Œå¼€å‘è€…å¯è‡ªå®šä¹‰JSON æ•°æ®ï¼Œç»è¿‡ <code>JSON.stringify()</code> å¤„ç†åä¼ é€’ã€‚é€šè¿‡ <code>data</code> å¯è‡ªå®šä¹‰å®ç°ä¸€äº›å¤æ‚åŠŸèƒ½ï¼Œä¾‹å¦‚ <a href="/docs/guide/dive/withdraw#%E5%BF%AB%E9%80%9F%E6%8F%90%E7%8E%B0-data-%E5%AD%97%E6%AE%B5%E8%AF%B4%E6%98%8E">å¿«é€Ÿæç°</a>ã€<a href="/docs/guide/dive/bundle">æ‰¹é‡è½¬è´¦</a></td></tr><tr><td>version</td><td>äº¤æ˜“ç‰ˆæœ¬ <code>&#x27;v1&#x27;</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹"></a>ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹<a class="hash-link" href="#ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> everpayTxWithoutSig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenSymbol</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;usdt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;transfer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword module" style="color:#00009f">from</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x26361130d5d6E798E9319114643AF8c868412859&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  to</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5260000&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  feeRecipient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  nonce</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1626079771946&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0xd85476c906b5301e8e9eb58d174a6f96b9dfc5ee&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ethereum&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;42&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;v1&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="arweave-è´¦æˆ·ç¤ºä¾‹"></a>Arweave è´¦æˆ·ç¤ºä¾‹<a class="hash-link" href="#arweave-è´¦æˆ·ç¤ºä¾‹" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> everpayTxWithoutSig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenSymbol</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;transfer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  to</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x26361130d5d6E798E9319114643AF8c868412859&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;100&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  feeRecipient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  nonce</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1629276767583&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,0xcc9141efa8c20c7df0778748255b1487957811be&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arweave,ethereum&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0,42&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;v1&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="messagedata"></a>messageData<a class="hash-link" href="#messagedata" title="Direct link to heading">#</a></h2><p>ç”± Schema æŒ‰ç…§ç»Ÿä¸€æ ¼å¼ç”Ÿæˆï¼Œç”¨äºï¼š</p><ul><li>ä»¥å¤ªåŠ <code>personalSign</code> ç­¾å</li><li>ç”Ÿæˆ <code>everHash</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ç”Ÿæˆè§„åˆ™"></a>ç”Ÿæˆè§„åˆ™<a class="hash-link" href="#ç”Ÿæˆè§„åˆ™" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> getEverpayTxMessageData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">everpayTxWithoutSig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">EverpayTxWithoutSig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;tokenSymbol&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;from&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;to&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;amount&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;fee&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;feeRecipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;nonce&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;tokenID&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;chainType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;chainID&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;version&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">key</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">everpayTxWithoutSig</span><span class="token template-string interpolation punctuation" style="color:#393A34">[</span><span class="token template-string interpolation">key</span><span class="token template-string interpolation punctuation" style="color:#393A34">]</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…¶ä¸­ <code>EverpayTxWithoutSig</code> å¯å‚è€ƒ <a href="/docs/sdk/everpay-js/types#everpaytxwithoutsig">everpay-js types#EverpayTxWithoutSig</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹-1"></a>ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹<a class="hash-link" href="#ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">tokenSymbol:usdt</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">action:transfer</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">from:0x26361130d5d6E798E9319114643AF8c868412859</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">to:5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">amount:5260000</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">fee:0</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">feeRecipient:0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">nonce:1626079771946</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">tokenID:0xd85476c906b5301e8e9eb58d174a6f96b9dfc5ee</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainType:ethereum</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainID:42</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">data:{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">version:v1</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="arweave-è´¦æˆ·ç¤ºä¾‹-1"></a>Arweave è´¦æˆ·ç¤ºä¾‹<a class="hash-link" href="#arweave-è´¦æˆ·ç¤ºä¾‹-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">tokenSymbol:ar</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">action:transfer</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">from:5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">to:0x26361130d5d6E798E9319114643AF8c868412859</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">amount:100</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">fee:0</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">feeRecipient:0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">nonce:1629276767583</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">tokenID:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,0xcc9141efa8c20c7df0778748255b1487957811be</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainType:arweave,ethereum</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainID:0,42</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">data:{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">version:v1</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="everhash"></a>everHash<a class="hash-link" href="#everhash" title="Direct link to heading">#</a></h2><p>æ¯ä¸€ç¬” everPay äº¤æ˜“éƒ½æœ‰å”¯ä¸€æ ‡è¯†çš„ <code>everHash</code>ã€‚ç”± <code>messageData</code> ä½¿ç”¨ä»¥å¤ªåŠ <code>hashPersonalMessage</code> ç”Ÿæˆçš„ <code>personalMessageHash</code>ï¼Œå³ä¸º <code>everHash</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ç”Ÿæˆè§„åˆ™-1"></a>ç”Ÿæˆè§„åˆ™<a class="hash-link" href="#ç”Ÿæˆè§„åˆ™-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// cp from: https://github.com/ethereumjs/ethereumjs-util/blob/ebf40a0fba8b00ba9acae58405bca4415e383a0d/src/signature.ts#L168</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> hashPersonalMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">\u0019Ethereum Signed Message:\n</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">toString</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keccak256</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">prefix</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> getPersonalMessageHash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMsgBuf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hashPersonalMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMessageHash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">0x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">personalMsgBuf</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">toString</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation string" style="color:#e3116c">&#x27;hex&#x27;</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> personalMessageHash</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="signature"></a>signature<a class="hash-link" href="#signature" title="Direct link to heading">#</a></h2><p>æ¯ä¸€ç¬” everPay äº¤æ˜“ï¼Œéƒ½éœ€è¦é€šè¿‡ å‘é€è€…è´¦æˆ·çš„é’±åŒ…è¿›è¡Œç­¾åï¼ŒeverPay æœåŠ¡å™¨ä¼šæ ¡éªŒæ‰€æœ‰ç­¾åçš„æœ‰æ•ˆæ€§ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹"></a>ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹<a class="hash-link" href="#ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹" title="Direct link to heading">#</a></h3><p>é€šè¿‡ ethereum <code>personalSign</code> ç­¾å <code>messageData</code> å¾—åˆ° <code>signature</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="é€šè¿‡-ethersjs-ç”Ÿæˆç­¾å"></a>é€šè¿‡ ethers.js ç”Ÿæˆç­¾å<a class="hash-link" href="#é€šè¿‡-ethersjs-ç”Ÿæˆç­¾å" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> everpayTxWithoutSig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenSymbol</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;usdt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;transfer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x26361130d5d6E798E9319114643AF8c868412859&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  to</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5260000&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  feeRecipient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  nonce</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1626079771946&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0xd85476c906b5301e8e9eb58d174a6f96b9dfc5ee&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ethereum&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;42&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;v1&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// const messageData = getEverpayTxMessageData(everpayTxWithoutSig)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">tokenSymbol:usdt</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">action:transfer</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">from:0x26361130d5d6E798E9319114643AF8c868412859</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">to:5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">amount:5260000</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">fee:0</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">feeRecipient:0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">nonce:1626079771946</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">tokenID:0xd85476c906b5301e8e9eb58d174a6f96b9dfc5ee</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainType:ethereum</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainID:42</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">data:{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">version:v1</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// personalSign</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signMessageAsync </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ethConnectedSigner</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Signer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> ethConnectedSigner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">signMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">signMessageAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ethConnectedSigner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> messageData</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¼ªä»£ç å‚è€ƒæ¥æºï¼š<a href="https://github.com/everFinance/everpay-js/blob/main/src/lib/sign.ts" target="_blank" rel="noopener noreferrer">everpay-js src/lib/sign.ts</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="arweave-è´¦æˆ·æ¨¡å‹"></a>Arweave è´¦æˆ·æ¨¡å‹<a class="hash-link" href="#arweave-è´¦æˆ·æ¨¡å‹" title="Direct link to heading">#</a></h3><p>ç”± <code>messageData</code> ä½¿ç”¨ä»¥å¤ªåŠ <code>hashPersonalMessage</code> ç”Ÿæˆçš„ <code>personalMessageHash</code>ã€‚é€šè¿‡ arweave RSA-PSS sha256 ç­¾å <code>personalMessageHash</code> å¯¹åº”çš„ <code>Uint8Array</code>ï¼ˆæˆ–è€… <code>Buffer</code>ï¼‰ï¼Œå¾—åˆ°çš„ç­¾åç»“æœï¼Œå†é€šè¿‡ <code>Arweave.utils.bufferTob64Url</code>ï¼ˆä¸å…¶ä»– base64 è½¬æ¢å‡½æ•°æœ‰å·®å¼‚ï¼‰ è¿›è¡Œ <code>base64</code> è½¬æ¢ï¼Œæ‹¼æ¥ä¸Š <code>,{{arOwner}}</code> åï¼Œå¾—åˆ° <code>signature</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="é€šè¿‡-arweavejs-ç”Ÿæˆç­¾å"></a>é€šè¿‡ arweave.js ç”Ÿæˆç­¾å<a class="hash-link" href="#é€šè¿‡-arweavejs-ç”Ÿæˆç­¾å" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// RSA-PSS sha256</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signMessageAsync </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arJWK</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ArJWK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> address</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> personalMessageHash</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> arweave </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMessageHashBuffer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">personalMessageHash</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hex&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> arOwner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> signatureB64url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// web</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arJWK </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;use_wallet&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkArPermissions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ACCESS_PUBLIC_KEY&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">ERRORS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ACCESS_PUBLIC_KEY_PERMISSION_NEEDED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      arOwner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">arweaveWallet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getActivePublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">ERRORS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ACCESS_PUBLIC_KEY_FAILED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkArPermissions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;SIGNATURE&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">ERRORS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">SIGNATURE_PERMISSION_NEEDED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> algorithm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;RSA-PSS&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      saltLength</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">arweaveWallet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">signature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        personalMessageHashBuffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        algorithm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Uint8Array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">signature</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      signatureB64url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bufferTob64Url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">ERRORS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">SIGNATURE_FAILED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// node</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crypto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arJWK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> personalMessageHashBuffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      saltLength</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    arOwner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arJWK</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">n</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    signatureB64url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bufferTob64Url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">signatureB64url</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">,</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arOwner</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> everpayTxWithoutSig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenSymbol</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;transfer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  to</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x26361130d5d6E798E9319114643AF8c868412859&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;100&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  feeRecipient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  nonce</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1629276767583&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,0xcc9141efa8c20c7df0778748255b1487957811be&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arweave,ethereum&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0,42&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;v1&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// const messageData = getEverpayTxMessageData(everpayTxWithoutSig)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">tokenSymbol:ar</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">action:transfer</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">from:5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">to:0x26361130d5d6E798E9319114643AF8c868412859</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">amount:100</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">fee:0</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">feeRecipient:0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">nonce:1629276767583</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">tokenID:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,0xcc9141efa8c20c7df0778748255b1487957811be</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainType:arweave,ethereum</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">chainID:0,42</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">data:{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">version:v1</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// cp from: https://github.com/ethereumjs/ethereumjs-util/blob/ebf40a0fba8b00ba9acae58405bca4415e383a0d/src/signature.ts#L168</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">hashPersonalMessage</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">\u0019Ethereum Signed Message:\n</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">toString</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keccak256</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">prefix</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> getPersonalMessageHash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMsgBuf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hashPersonalMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMessageHash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">0x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">personalMsgBuf</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">toString</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation string" style="color:#e3116c">&#x27;hex&#x27;</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> personalMessageHash</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> personalMessageHash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPersonalMessageHash</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">signMessageAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">arJWK</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">ArJWK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> personalMessageHash</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¼ªä»£ç å‚è€ƒæ¥æºï¼š<a href="https://github.com/everFinance/everpay-js/blob/main/src/lib/sign.ts" target="_blank" rel="noopener noreferrer">everpay-js src/lib/sign.ts</a></p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</h5></div><div class="admonition-content"><ul><li>ç”¨äº ä»¥å¤ªåŠ personalSign ç­¾åçš„æ˜¯ <code>messageData</code> stringï¼Œå¾—åˆ°çš„ç»“æœå³ä¸º <code>signature</code></li><li>ç”¨äº arweave RSA-PSS sha256 ç­¾åçš„æ˜¯ <code>personalMessageHash</code> Bufferï¼Œå¾—åˆ°çš„ç»“æœéœ€è¦è¿›ä¸€æ­¥é€šè¿‡ <code>Arweave.utils.bufferTob64Url</code> è½¬æ¢å¾—åˆ°çš„ <code>base64 string</code>ï¼Œå¹¶æ‹¼æ¥ä¸Š <code>,{{arOwner}}</code> æ‰æ˜¯ <code>signature</code></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="signature-æ ¡éªŒ"></a>signature æ ¡éªŒ<a class="hash-link" href="#signature-æ ¡éªŒ" title="Direct link to heading">#</a></h2><p>æ¯ä¸€ç¬” everPay äº¤æ˜“ï¼Œé€šè¿‡ å‘é€è€…è´¦æˆ·çš„é’±åŒ…è¿›è¡Œç­¾ååï¼Œå°†ç­¾å everPay äº¤æ˜“ä¸€èµ·æäº¤ everPay æœåŠ¡å™¨ï¼ŒeverPay æœåŠ¡å™¨ä¼šæ ¡éªŒæ‰€æœ‰ç­¾åï¼Œæ¥ç¡®ä¿äº¤æ˜“çš„æœ‰æ•ˆæ€§ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹-1"></a>ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹<a class="hash-link" href="#ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">signMessageAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ethConnectedSigner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> messageData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> verified </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">verifyMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLowerCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> everpayTxWithoutSig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLowerCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="arweave-è´¦æˆ·æ¨¡å‹-1"></a>Arweave è´¦æˆ·æ¨¡å‹<a class="hash-link" href="#arweave-è´¦æˆ·æ¨¡å‹-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">signMessageAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">arJWK</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">ArJWK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> everHash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// arOwner ä¸º arweave é’±åŒ… publicKey</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sigB64url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arOwner</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> signature</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> verified </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crypto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">verify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  arOwner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">everHash</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Arweave</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">b64UrlToBuffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sigB64url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æäº¤äº¤æ˜“"></a>æäº¤äº¤æ˜“<a class="hash-link" href="#æäº¤äº¤æ˜“" title="Direct link to heading">#</a></h2><p>å°† everPay äº¤æ˜“é€šè¿‡ POST è¯·æ±‚æäº¤ everPay åç«¯æœåŠ¡å™¨ <a href="/docs/sdk/server-api/operation-api/tx"><code>tx</code></a> æ¥å£ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="å­—æ®µ"></a>å­—æ®µ<a class="hash-link" href="#å­—æ®µ" title="Direct link to heading">#</a></h3><p>é™¤ <a href="#schema"><code>Schema</code></a> å®šä¹‰å­—æ®µå¤–ï¼Œè¡¥å……ç­¾åå¾—åˆ°<code>signature</code> ä½œä¸º <code>sig</code> å­—æ®µã€‚</p><table><thead><tr><th>è¡¥å……å­—æ®µ</th><th>æè¿°</th></tr></thead><tbody><tr><td>sig</td><td>æ ¹æ®ä¸åŒè´¦æˆ·æ¨¡å‹ç­¾åï¼Œç”Ÿæˆçš„ <code>signature</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ç¤ºä¾‹"></a>ç¤ºä¾‹<a class="hash-link" href="#ç¤ºä¾‹" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenSymbol</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;transfer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword module" style="color:#00009f">from</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5NPqYBdIsIpJzPeYixuz7BEH_W7BEk_mb8HxBD3OHXo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  to</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x26361130d5d6E798E9319114643AF8c868412859&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;100&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  feeRecipient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x6451eB7f668de69Fb4C943Db72bCF2A73DeeC6B1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  nonce</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1629276767583&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tokenID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,0xcc9141efa8c20c7df0778748255b1487957811be&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arweave,ethereum&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0,42&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;hello&quot;:&quot;world&quot;,&quot;this&quot;:&quot;is everpay&quot;}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;v1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Lg8Xgk_LZn_H-HVOz042wbhv5RVQjc7Z0iVV4_UbWWgoqHnboB6PQujtCtu1_QW0cXPqakm9sLi7fJlhK7Hm7UMFQiwXbVB_bClr73GKAcV0tpWye9BUsKw9SfOnFAHCCufF4C1PPt4xRrJp5UeG-smonQ9k4t0GmoXnXoSfmFxsEvaId5SeNaOZa1JYMzReo8-P4m5EdrTKLNgWwo28OOi4GbpXIzRxorJp-dwhsNhQHu4vzOq4rflGRwQKb9bj4S92YqEp2wXRRU7ebEiBJlGjQrf0HgTr7gZO_q3gI5FQgsL_UbOo4sp5hL69IUOfRxmr_RTiLZZzQRu-0dJBsWOSWYC5232fRf3MwogIELdDUl3dVCz5PDnXp8AOPKBQCiblu74oTSyKhsVMvwfER125dXyKtxJLlxTkDhEOPzTJdufy-Czs1pE_ZPKj4z44P3W7UdGiAt9rXYQb6JjMNOpG1_S7RMa5OKoCV4MbuK2CGFCNBE0h4zxeXZfXLOMSImrfFZ4nZAHkTbpKgpH1hPDEMGsEEgwvDl6_AyjrMOebAAyJGj6keyy9tf7lQBKKaj2-bGG6PIVC-l7wCXJizFt-3Cb0aC6ZXaCHGdhHuI-7Ime4M5iZESiBhkIhtOV3ADjqks174o0J0zKxE0NVl14tuu5tY-UfJ6kAkqbujLs,odtNk97a4PARR0I8g3kQpzlFVmPg-udyjfl81fbTioyP2pEw5tP5A1-FVqR-QFFPskW-j7yAze5usYNWHEir7oVQ9d9bbkcZIDEPqwSTO1JoD1BKXeeBK0xsmiSgxeY7uuRXWdhXREhlmIMsV8ObakEeXdbbxbs89XaZHBuES7boASrRVDXRz_mhMu6u_58OdLeMwR3I1BCH6nphNGVOehA7GOOqEBvtesBset0bNaLCb0JpSg5ZW_0AGLP-XydzE3IPLLx4NQEEJY21y8fChxYM4jntI78l5hojp9NlmS69EXlj0PoMjsbaWaz9WtnZaMAbnaOGAHhv8Y_TNmBI0FHpqHaGPP906Mnrgdm3tl2L40EX-Q6-liNVkB56CmPxXzSesu-4x5LLYxQ-aX3W6Hj7RCDTacxqUJHzOrhJqXSx6Jx0t8CwyfReMgVv4p5t1C3OZ8yYbJ_H3LdkeriVniaC5jQdMyIJ6QBMzr1XdXIw9WuEG2kCIYtvOp2qDuu9o2SY-9W4Yv7VWRDfWO38xxR4ZO65MMAdZxeaZ4w8sK_owH46Wm0XoT3Al-LPypaeijWqlHEu4R8c2ersD3xkDvXC_lNtaQw_qyfI3UEH5fWupY4zhZeDGkvXQh32Fv4CxlZL58iUHv9SvR7p5LgBCC3AVUbn7Sqc4xPUCZMj-Tc&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="nonce"></a>nonce<a class="hash-link" href="#nonce" title="Direct link to heading">#</a></h3><ul><li><code>nonce</code> ä¸ºç”¨æˆ·åœ¨å®¢æˆ·ç«¯ç”Ÿæˆï¼ŒeverPay æœåŠ¡å™¨å¯æ¥æ”¶ä¸æœåŠ¡å™¨æ—¶é—´ä¸Šä¸‹ 100s çš„è¯¯å·®</li><li>ç”¨æˆ·æ¯æ¬¡æäº¤ everPay çš„äº¤æ˜“ï¼Œ<code>nonce</code> å¿…é¡»æ¯”è¯¥ç”¨æˆ·ä¸Šä¸€ç¬” <code>nonce</code> æ•°å€¼å¤§</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="äº¤æ˜“è®°å½•"></a>äº¤æ˜“è®°å½•<a class="hash-link" href="#äº¤æ˜“è®°å½•" title="Direct link to heading">#</a></h2><p>æäº¤è‡³ everPay æœåŠ¡å™¨ï¼Œç»è¿‡ç­¾åæ ¡éªŒé€šè¿‡çš„ everPay äº¤æ˜“ï¼Œå¯ä»¥é€šè¿‡ everPay æ¥å£è·å–äº¤æ˜“è®°å½•ã€‚</p><p>everPay åœ¨ <a href="#schema"><code>Schema</code></a> å®šä¹‰å­—æ®µã€<code>sig</code> ç­¾åå­—æ®µå¤–ï¼Œæ·»åŠ äº†éƒ¨åˆ†å­—æ®µï¼Œç”¨äº everPay ä¸šåŠ¡ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="å­—æ®µ-1"></a>å­—æ®µ<a class="hash-link" href="#å­—æ®µ-1" title="Direct link to heading">#</a></h3><table><thead><tr><th>è¡¥å……å­—æ®µ</th><th>æè¿°</th></tr></thead><tbody><tr><td>everHash</td><td>æ¯ç¬” everPay äº¤æ˜“éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„ <code>everHash</code>ï¼Œ<code>everHash</code> ç”Ÿæˆå‚è€ƒ <a href="#everhash">everHash</a></td></tr><tr><td>timestamp</td><td><ul><li>å½“è¯¥ç¬” everPay äº¤æ˜“è¢«è®°å½•åˆ° Arweave åŒºå—é“¾åï¼Œæ­¤ <code>timestamp</code> ä»£è¡¨ everPay äº¤æ˜“è¢«è®°å½•åˆ° Arweave åŒºå—é“¾çš„ unix millisecondsï¼Œunix æ¯«ç§’æ—¶é—´æˆ³</li><li>å¦‚è¯¥ç¬” everPay äº¤æ˜“æœªè¢«è®°å½•åˆ° Arweave åŒºå—é“¾ä¸Šï¼Œ<code>timestamp</code> ä¸º <code>0</code></li></ul></td></tr><tr><td>status</td><td><ul><li><code>confirmed</code> ä»£è¡¨è¯¥ everPay äº¤æ˜“è¢« everPay åç«¯ç­¾åéªŒè¯é€šè¿‡åï¼Œç¡®è®¤æ¥æ”¶ï¼Œä½†è¿˜æœªè®°å½•åˆ° Arweave åŒºå—é“¾ä¸Š</li><li><code>packaged</code> ä»£è¡¨è¯¥ everPay äº¤æ˜“å·²è¢«è®°å½•åˆ° Arweave åŒºå—é“¾ä¸Š</li></ul></td></tr><tr><td>internalStatus</td><td>æ‰¹é‡è½¬è´¦å¢åŠ çš„å­—æ®µï¼Œä»…åœ¨æ‰¹é‡è½¬è´¦çš„å†…éƒ¨äº¤æ˜“å¤±è´¥æ—¶ï¼Œè¿”å›å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚æ‰¹é‡è½¬è´¦å†…éƒ¨äº¤æ˜“æˆåŠŸã€è½¬è´¦ã€æç°ã€å……å€¼æ—¶ï¼Œå€¼éƒ½ä¸º <code>success</code></td></tr><tr><td>id</td><td><ul><li>å½“è¯¥ç¬” everPay äº¤æ˜“è¢«è®°å½•åˆ° Arweave åŒºå—é“¾åï¼Œæ­¤ <code>id</code> å¯¹åº”è¯¥ç¬”è®°å½•åœ¨ Arweave ä¸Šçš„äº¤æ˜“ hash</li><li>å¦‚è¯¥ç¬” everPay äº¤æ˜“æœªè¢«è®°å½•åˆ° Arweave åŒºå—é“¾ä¸Šï¼Œ<code>id</code> ä¸ºç©ºå­—ç¬¦ä¸²</li></ul></td></tr><tr><td>targetChainTxHash</td><td><ul><li>å……å€¼ã€æç°ï¼ˆéå¿«é€Ÿæç°ï¼‰æ—¶ï¼Œå¯¹åº”çš„åŒºå—é“¾ <code>txHash</code></li><li>å¦‚æç°ï¼ˆéå¿«é€Ÿæç°ï¼‰æœªå®Œæˆæˆ–æ˜¯ everPay è½¬è´¦äº¤æ˜“ï¼Œæ­¤ <code>targetChainTxHash</code> ä¸ºç©ºå­—ç¬¦ä¸²</li></ul></td></tr><tr><td>express</td><td>å¿«é€Ÿæç°å¢åŠ çš„å­—æ®µï¼Œ<code>express: {&quot;chainTxHash&quot;: &quot;&quot;,&quot;withdrawFee&quot;: &quot;&quot;,&quot;refundEverHash&quot;: &quot;&quot;,&quot;err&quot;: &quot;&quot;}</code><ul><li><code>chainTxHash</code> ä»£è¡¨å¿«é€Ÿæç°æˆåŠŸåï¼Œæ‰“åŒ…çš„ åŒºå—é“¾ <code>txHash</code></li><li><code>withdrawFee</code> ä»£è¡¨å®é™…æ”¶å–çš„æ‰‹ç»­è´¹</li><li><code>refundEverHash</code> ä»£è¡¨å¿«é€Ÿæç°å¤±è´¥åï¼Œåšå¸‚å•†è¿›è¡Œé€€æ¬¾çš„ everPay äº¤æ˜“ <code>everHash</code></li><li><code>err</code> ä»£è¡¨å¿«é€Ÿæç°å¤±è´¥åŸå› </li></ul></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="æŸ¥è¯¢æ¥å£"></a>æŸ¥è¯¢æ¥å£<a class="hash-link" href="#æŸ¥è¯¢æ¥å£" title="Direct link to heading">#</a></h3><ul><li><a href="/docs/sdk/server-api/basic-api/txs">txs</a> æŸ¥è¯¢æ‰€æœ‰ everPay äº¤æ˜“è®°å½•</li><li><a href="/docs/sdk/server-api/basic-api/txsByAccount">txsByAccount</a> æŸ¥è¯¢å…·ä½“ everPay è´¦æˆ·çš„äº¤æ˜“è®°å½•</li><li><a href="/docs/sdk/server-api/basic-api/txByHash">txByHash</a> æ ¹æ® <code>everHash</code> æŸ¥è¯¢ everPay äº¤æ˜“è®°å½•</li><li><a href="/docs/sdk/server-api/basic-api/mintedTxByChainTxHash">mintedTxByChainTxHash</a> æ ¹æ®å……å€¼çš„åŒºå—é“¾è®°å½•ID ï¼ˆå¦‚ä»¥å¤ªåŠä¸º <code>txHash</code>ï¼‰ï¼ŒæŸ¥è¯¢å……å€¼çš„ everPay äº¤æ˜“è®°å½•</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/everFinance/docs/edit/master/docs/guide/dive/transaction.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guide/dive/account-model"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« è´¦æˆ·æ¨¡å‹</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guide/dive/deposit"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å……å€¼ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#schema" class="table-of-contents__link">Schema</a><ul><li><a href="#ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹" class="table-of-contents__link">ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹</a></li><li><a href="#arweave-è´¦æˆ·ç¤ºä¾‹" class="table-of-contents__link">Arweave è´¦æˆ·ç¤ºä¾‹</a></li></ul></li><li><a href="#messagedata" class="table-of-contents__link">messageData</a><ul><li><a href="#ç”Ÿæˆè§„åˆ™" class="table-of-contents__link">ç”Ÿæˆè§„åˆ™</a></li><li><a href="#ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹-1" class="table-of-contents__link">ä»¥å¤ªåŠè´¦æˆ·ç¤ºä¾‹</a></li><li><a href="#arweave-è´¦æˆ·ç¤ºä¾‹-1" class="table-of-contents__link">Arweave è´¦æˆ·ç¤ºä¾‹</a></li></ul></li><li><a href="#everhash" class="table-of-contents__link">everHash</a><ul><li><a href="#ç”Ÿæˆè§„åˆ™-1" class="table-of-contents__link">ç”Ÿæˆè§„åˆ™</a></li></ul></li><li><a href="#signature" class="table-of-contents__link">signature</a><ul><li><a href="#ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹" class="table-of-contents__link">ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹</a></li><li><a href="#arweave-è´¦æˆ·æ¨¡å‹" class="table-of-contents__link">Arweave è´¦æˆ·æ¨¡å‹</a></li></ul></li><li><a href="#signature-æ ¡éªŒ" class="table-of-contents__link">signature æ ¡éªŒ</a><ul><li><a href="#ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹-1" class="table-of-contents__link">ä»¥å¤ªåŠè´¦æˆ·æ¨¡å‹</a></li><li><a href="#arweave-è´¦æˆ·æ¨¡å‹-1" class="table-of-contents__link">Arweave è´¦æˆ·æ¨¡å‹</a></li></ul></li><li><a href="#æäº¤äº¤æ˜“" class="table-of-contents__link">æäº¤äº¤æ˜“</a><ul><li><a href="#å­—æ®µ" class="table-of-contents__link">å­—æ®µ</a></li><li><a href="#ç¤ºä¾‹" class="table-of-contents__link">ç¤ºä¾‹</a></li><li><a href="#nonce" class="table-of-contents__link">nonce</a></li></ul></li><li><a href="#äº¤æ˜“è®°å½•" class="table-of-contents__link">äº¤æ˜“è®°å½•</a><ul><li><a href="#å­—æ®µ-1" class="table-of-contents__link">å­—æ®µ</a></li><li><a href="#æŸ¥è¯¢æ¥å£" class="table-of-contents__link">æŸ¥è¯¢æ¥å£</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">æ–‡æ¡£</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/guide/quick-start/overview">æŒ‡å—</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sdk/intro">SDK</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾ç¾¤</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/FinanceEver" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/WM5MQZGVPF" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://medium.com/everfinance" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/everFinance/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/everFinance/everpay-js" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>everpay-js<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 everFinance, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2c9cfe4d.js"></script>
<script src="/assets/js/main.c9bb03f8.js"></script>
</body>
</html>