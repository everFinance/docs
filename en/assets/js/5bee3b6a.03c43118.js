"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[8789],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8568:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:2},o="Quick integration with everpay-js",l={unversionedId:"guide/SDK/everpay-js",id:"guide/SDK/everpay-js",title:"Quick integration with everpay-js",description:"everpay-js encapsulates most of the interfaces of everPay protocol for developers, developers can use everpay-js to quickly integrate everPay protocol into application pages. Using everpay-js, you can quickly complete everPay payment settlement in your application.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/guide/SDK/everpay-js.md",sourceDirName:"guide/SDK",slug:"/guide/SDK/everpay-js",permalink:"/en/docs/guide/SDK/everpay-js",draft:!1,editUrl:"https://github.com/everFinance/docs/edit/master/i18n/en/docusaurus-plugin-content-docs/current/guide/SDK/everpay-js.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"guide",previous:{title:"Introduction",permalink:"/en/docs/guide/SDK/intro"},next:{title:"installation",permalink:"/en/docs/guide/SDK/everpay-js/installation"}},p={},s=[{value:"Requirements for use",id:"requirements-for-use",level:2},{value:"Installation",id:"installation",level:2},{value:"Import",id:"import",level:2},{value:"Initialization",id:"initialization",level:2},{value:"Connecting with an ethereum wallet",id:"connecting-with-an-ethereum-wallet",level:3},{value:"CDN way to connect Ethereum wallet",id:"cdn-way-to-connect-ethereum-wallet",level:3},{value:"Connecting with an arweave wallet",id:"connecting-with-an-arweave-wallet",level:3},{value:"CDN way to connect Arweave wallet",id:"cdn-way-to-connect-arweave-wallet",level:3},{value:"Deposit",id:"deposit",level:2},{value:"Transfer",id:"transfer",level:2},{value:"Withdrawal",id:"withdrawal",level:2},{value:"Example reference",id:"example-reference",level:2}],c={toc:s},d="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"quick-integration-with-everpay-js"},"Quick integration with everpay-js"),(0,r.kt)("p",null,"everpay-js encapsulates most of the interfaces of everPay protocol for developers, developers can use everpay-js to quickly integrate everPay protocol into application pages. Using everpay-js, you can quickly complete everPay payment settlement in your application."),(0,r.kt)("h2",{id:"requirements-for-use"},"Requirements for use"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Node Version >= 14")," It is recommended to use ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/nvm-sh/nvm"},(0,r.kt)("inlineCode",{parentName:"a"},"nvm"))," or ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/coreybutler/nvm-windows"},"nvm-windows")," (windows) to manage Node versions."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.ethers.io/v5/"},"ethers.js")," (only required when using the ethers wallet connection). Recommended to use ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/everFinance/everpay-js/blob/main/package.json#L57"},"the same version within everpay-js ethers.js"))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"This section explains how to quickly install, introduce, create, top up, transfer and withdraw funds using everpay-js."))),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("p",null,"Use ",(0,r.kt)("a",{parentName:"p",href:"https://www.yarnpkg.cn/getting-started/install"},"yarn")," or npm to install and use, if not please check your network and try again."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add everpay\n\n# or\n\nnpm install everpay\n")),(0,r.kt)("h2",{id:"import"},"Import"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import Everpay from 'everpay'\n\n// or\n\nconst Everpay = require('everpay')\n")),(0,r.kt)("h2",{id:"initialization"},"Initialization"),(0,r.kt)("h3",{id:"connecting-with-an-ethereum-wallet"},"Connecting with an ethereum wallet"),(0,r.kt)("p",null,"To create an ",(0,r.kt)("inlineCode",{parentName:"p"},"ethConnectedSigner"),", developers install and create it using ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ethers-io/ethers.js"},"ethers.js"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Please download ",(0,r.kt)("a",{parentName:"li",href:"https://metamask.io/"},"MetaMask")," or other ethernet wallets")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add ethers\n# or\nnpm install ethers\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import Everpay from 'everpay'\nimport { ethers } from 'ethers'\n\nconst provider = new ethers.providers.Web3Provider(window.ethereum)\nconst signer = provider.getSigner()\nconst everpay = new Everpay({\n  account: window.ethereum.selectedAddress,\n  chainType: 'ethereum',\n  ethConnectedSigner: signer\n})\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"./everpay-js/types#chaintype"},"chainType configuration item")),(0,r.kt)("li",{parentName:"ul"},"More ways to create ",(0,r.kt)("inlineCode",{parentName:"li"},"ethConnectedSigner")," can be found at ",(0,r.kt)("a",{parentName:"li",href:"./everpay-js/configuration/ethConnectedSigner"},"SDK - everpay-js - Configuration Items - ",(0,r.kt)("inlineCode",{parentName:"a"},"ethConnectedSigner")),"."))),(0,r.kt)("h3",{id:"cdn-way-to-connect-ethereum-wallet"},"CDN way to connect Ethereum wallet"),(0,r.kt)("p",null,"When creating, you need to introduce the everpay-js package and ethers package in the ",(0,r.kt)("inlineCode",{parentName:"p"},"head")," of the ",(0,r.kt)("inlineCode",{parentName:"p"},"index.html")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<script\n  src="https://cdn.jsdelivr.net/npm/everpay@0.6.1/umd/index.umd.js"\n  defer\n  type="text/javascript"\n><\/script>\n<script\n  src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.4.0/ethers.umd.min.js"\n  defer\n  type="application/javascript"\n><\/script>\n')),(0,r.kt)("p",null,"After the import is successful, create a ",(0,r.kt)("inlineCode",{parentName:"p"},"script")," tag again and fill it according to the following code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},"<script type=\"text/javascript\" defer>\nconst ethRun = async () => {\n    // If you are not connected, you can connect to the wallet and connect to the site here\n    const provider = new ethers.providers.Web3Provider(window.ethereum)\n    const signer = provider.getSigner()\n    const everpay = new window.Everpay.default({\n      account: window.ethereum.selectedAddress,\n      chainType: 'ethereum',\n      ethConnectedSigner: signer\n    })\n}\nethRun()\n<\/script>\n")),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Make sure the wallet is connected and the current site is connected."),(0,r.kt)("li",{parentName:"ul"},"When creating an everpay application, you need to add ",(0,r.kt)("inlineCode",{parentName:"li"},"default"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"new window.Everpay.default({})"),"."),(0,r.kt)("li",{parentName:"ul"},"ethers CDN version Please use ",(0,r.kt)("inlineCode",{parentName:"li"},"umd")," format, ",(0,r.kt)("a",{parentName:"li",href:"https://cdnjs.com/libraries/ethers/5.4.0"},"View ethers CDN version"),"."),(0,r.kt)("li",{parentName:"ul"},"Make sure ",(0,r.kt)("inlineCode",{parentName:"li"},"ethers CDN link")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"everpay CDN link")," are loaded first, otherwise ",(0,r.kt)("inlineCode",{parentName:"li"},"ethers is not defined")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"Everpay is not defined"),"."))),(0,r.kt)("h3",{id:"connecting-with-an-arweave-wallet"},"Connecting with an arweave wallet"),(0,r.kt)("p",null,"If the developer uses Arweave wallet connection, the initialization needs to inject ",(0,r.kt)("inlineCode",{parentName:"p"},"arJWK"),". When using the browser ",(0,r.kt)("a",{parentName:"p",href:"https://arconnect.io/"},"ArConnect")," wallet, injecting ",(0,r.kt)("inlineCode",{parentName:"p"},"arJWK: 'use_wallet'")," will do the trick."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download ",(0,r.kt)("a",{parentName:"li",href:"https://arconnect.io/"},"ArConnect")," Wallet")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"import Everpay from 'everpay'\n\nconst arAddress = await window.arweaveWallet.getActiveAddress()\nconst everpay = new Everpay({\n  account: arAddress,\n  chainType: 'arweave',\n  arJWK: 'use_wallet'\n})\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"./everpay-js/types#chaintype"},"chainType configuration item")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"arJWK")," also supports the private key format, you can browse ",(0,r.kt)("a",{parentName:"li",href:"./everpay-js/configuration/arJWK"},"SDK - everpay-js - Configuration - ",(0,r.kt)("inlineCode",{parentName:"a"},"arJWK"))," for configuration.")),(0,r.kt)("h3",{id:"cdn-way-to-connect-arweave-wallet"},"CDN way to connect Arweave wallet"),(0,r.kt)("p",null,"When creating, you need to introduce the everpay-js package in the ",(0,r.kt)("inlineCode",{parentName:"p"},"head")," of the ",(0,r.kt)("inlineCode",{parentName:"p"},"index.html")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<script\n  src="https://cdn.jsdelivr.net/npm/everpay@0.6.1/umd/index.umd.js"\n  defer\n  type="text/javascript"\n><\/script>\n')),(0,r.kt)("p",null,"After the import is successful, create a ",(0,r.kt)("inlineCode",{parentName:"p"},"script")," tag again and fill it according to the following code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},"<script>\nconst arRun = async () => {\n  // If you are not connected, you can connect to the wallet and connect to the site here\n  const arAddress = await window.arweaveWallet.getActiveAddress()\n  const everpay = new window.Everpay.default({\n    account: arAddress,\n    chainType: 'arweave',\n    arJWK: 'use_wallet'\n  })\n}\narRun()\n<\/script>\n")),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Make sure the wallet is connected and connected to the current site."),(0,r.kt)("li",{parentName:"ul"},"You need to add ",(0,r.kt)("inlineCode",{parentName:"li"},"default")," when creating everpay application: ",(0,r.kt)("inlineCode",{parentName:"li"},"new window.Everpay.default({})"),"."),(0,r.kt)("li",{parentName:"ul"},"Make sure that the everpay CDN link is loaded first."))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Following the steps above, we have completed the creation of the Everpay application, so let's move on to top-up, transfer and withdraw funds."))),(0,r.kt)("h2",{id:"deposit"},"Deposit"),(0,r.kt)("p",null,"Deposit your Arweave, Ethereum and other on-chain assets to everPay.\nFill in the ",(0,r.kt)("inlineCode",{parentName:"p"},"token tag")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," for the top-up and call the following interface to complete the top-up:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"everpay.deposit({\n  tag: 'ethereum-usdt-0x923fcb255da521037385457fb549a51f78ef0af4',\n  amount: '5.21'\n}).then(console.log)\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Wait patiently for the block verification to be completed and you will have the corresponding property in everPay."),(0,r.kt)("li",{parentName:"ul"},"Ethereum requires 6 blocks for recharge, Arweave requires 15 blocks for recharge"),(0,r.kt)("li",{parentName:"ul"},"everPay supports AR cross-chain, initialization injection ",(0,r.kt)("inlineCode",{parentName:"li"},"ethConnectedSigner")," will call WAR (ERC20) for recharge, initialization injection ",(0,r.kt)("inlineCode",{parentName:"li"},"arJWK")," will call AR (native) for recharge"))),(0,r.kt)("h2",{id:"transfer"},"Transfer"),(0,r.kt)("p",null,"You can make an everPay transfer to a wallet that has a token that corresponds to an everPay account. Fill in the ",(0,r.kt)("inlineCode",{parentName:"p"},"token tag")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," of the account to be transferred and the address ",(0,r.kt)("inlineCode",{parentName:"p"},"to")," of the account to be transferred, and call the following interface to complete the transfer."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"everpay.transfer({\n  tag: 'ethereum-usdt-0x923fcb255da521037385457fb549a51f78ef0af4',\n  amount: '5.21',\n  to: '0x26361130d5d6E798E9319114643AF8c868412859'\n}).then(console.log)\n")),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Please note: You are operating a transfer of assets on the everPay network, please do not transfer to an exchange address, or a contract address, or your assets will not be recovered!"))),(0,r.kt)("h2",{id:"withdrawal"},"Withdrawal"),(0,r.kt)("p",null,"Withdraw the assets from everPay and return them to the native chain. Withdrawals from everPay can be made to the wallets that have been credited and have tokens in their everPay accounts. Fill in the ",(0,r.kt)("inlineCode",{parentName:"p"},"token tag"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"amount"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"chainType")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"to")," of the native chain to be withdrawn, and call the following interface to complete the withdrawal."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"everpay.withdraw({\n  tag: 'ethereum-usdt-0x923fcb255da521037385457fb549a51f78ef0af4',\n  amount: '5.26',\n  chainType: 'ethereum',\n  to: '0x26361130d5d6E798E9319114643AF8c868412859'\n}).then(console.log)\n")),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Withdraw assets from everPay to target chains, such as Ethereum, etc."),(0,r.kt)("li",{parentName:"ul"},"Please do not withdraw to contract addresses, they cannot be recovered!"))),(0,r.kt)("h2",{id:"example-reference"},"Example reference"),(0,r.kt)("p",null,"More examples can be found in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/everFinance/everpay-js/tree/main/test"},"everpay-js unit test cases")))}u.isMDXComponent=!0}}]);